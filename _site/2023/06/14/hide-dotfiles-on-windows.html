<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hide dotfiles on Windows | FelisDiligens’ blog</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Hide dotfiles on Windows" />
<meta name="author" content="FelisDiligens" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The absolute insanity that is the home folder on Windows" />
<meta property="og:description" content="The absolute insanity that is the home folder on Windows" />
<link rel="canonical" href="http://localhost:4000/2023/06/14/hide-dotfiles-on-windows.html" />
<meta property="og:url" content="http://localhost:4000/2023/06/14/hide-dotfiles-on-windows.html" />
<meta property="og:site_name" content="FelisDiligens’ blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-06-14T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hide dotfiles on Windows" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"FelisDiligens"},"dateModified":"2023-06-14T00:00:00+02:00","datePublished":"2023-06-14T00:00:00+02:00","description":"The absolute insanity that is the home folder on Windows","headline":"Hide dotfiles on Windows","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/06/14/hide-dotfiles-on-windows.html"},"url":"http://localhost:4000/2023/06/14/hide-dotfiles-on-windows.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="FelisDiligens&apos; blog" />
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">FelisDiligens&#39; blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/posts/">Posts</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <style>
    .tags {
        color: gray;
        font-size: 10pt;
        list-style: none;
        padding: 4px 0;
        margin: 0;
    }

    .tags > li {
        display: inline-block;
        padding: 0 8px;
        margin: 0 2px;
        border: 1px solid gray;
        border-radius: 10px;
    }

    .tags > li > a {
        color: inherit;
    }
</style>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Hide dotfiles on Windows</h1>
    <p class="post-meta"><time class="dt-published" datetime="2023-06-14T00:00:00+02:00" itemprop="datePublished">
        Jun 14, 2023
      </time>

      <!-- Post tags -->
      <ul class="tags">
        Tags:&nbsp;<li><a href="/tags/windows">windows</a></li></ul></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <figure>
    <img src="/assets/posts/all-those-folders.png" />
    <figcaption style="font-size: 11pt; font-style: italic;">The absolute insanity that is the home folder on Windows</figcaption>
</figure>

<p>A lot of developers simply put dot files and folders into the home folder on Windows without adding the NTFS hidden attribute, resulting in an absolute mess as you can see in the screenshot.
Dot files and folders aren’t hidden on Windows, but developers just gladly ignore this fact, it seems.</p>

<p>Some background:</p>

<blockquote>
  <p>In Linux, and other UNIX like systems, a file with a name that starts by a dot (<code class="language-plaintext highlighter-rouge">.</code>) is considered a <em>hidden file</em>. Some file managers also hide files that end with a tilde (<code class="language-plaintext highlighter-rouge">~</code>), which are considered <em>backup files</em>. <sup><a href="https://github.com/brunonova/nautilus-hide">Source</a></sup> Typically files ending with a <code class="language-plaintext highlighter-rouge">~</code> are created by editors like emacs, nano, or vi. <sup><a href="https://unix.stackexchange.com/a/76192">Source</a></sup></p>
</blockquote>

<blockquote>
  <p>If you create the file <em>.hidden</em> in a directory in which you want to hide files or folders and enter the names of files or folders there without specifying the path, they will not be displayed in the file manager. <sup><a href="https://wiki.ubuntuusers.de/Versteckte_Dateien/">Source</a></sup></p>
</blockquote>

<h2 id="a-little-python-script">A little python script</h2>

<p>I wrote a little python script to have a tidy home folder once again.</p>

<p>You may want to check it out: <a href="https://gist.github.com/FelisDiligens/9886ede399e3a321797b43ab53a371f9">Gist: FelisDiligens/hide-files.py</a><br />
(I added a comment below the gist to explain usage)</p>

<p>The python script looks into each given directory (<code class="language-plaintext highlighter-rouge">%USERPROFILE%</code> or <code class="language-plaintext highlighter-rouge">~</code> by default) and add the NTFS hidden attribute to every file and folder that starts with a <code class="language-plaintext highlighter-rouge">.</code>.
As a bonus, it also reads <code class="language-plaintext highlighter-rouge">.hidden</code> files inside of directories and hides whatever entries are written in it.</p>

<p>However, it does not run on it’s own and it does not scan the entire disk (only given directories).
You have to do that manually or setup some service or a cron job to run it periodically.</p>

<p>Thankfully, you can setup a cron job using Cygwin, see below.</p>

<h2 id="run-cronjobs-under-windows">Run Cronjobs under Windows</h2>

<p><a href="https://www.cygwin.com/">Cygwin</a> can be used to create a Windows service that runs the <a href="https://en.wikipedia.org/wiki/Cron">cron</a> daemon.</p>

<p>First, you have to install <code class="language-plaintext highlighter-rouge">cygrunsrv</code> and <code class="language-plaintext highlighter-rouge">cron</code> using the Cygwin installer. (You can simply rerun it, if you already installed Cygwin)</p>

<p><img src="/assets/posts/cygwin-installer-cygrunsrv.png" alt="" /></p>

<blockquote>
  <p>ℹ️  <code class="language-plaintext highlighter-rouge">cygrunsrv</code> can be used to add daemons as a Windows service</p>
</blockquote>

<p>Then start an elevated bash shell (or use gsudo) to run:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cygrunsrv <span class="nt">-I</span> cron <span class="nt">-p</span> /usr/sbin/cron <span class="nt">-a</span> <span class="nt">-n</span>
</code></pre></div></div>

<p>Arguments breakdown:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">-I &lt;svc_name&gt;</code>: install a Windows service</li>
  <li><code class="language-plaintext highlighter-rouge">-p &lt;app_path&gt;</code>: path to POSIX program</li>
  <li><code class="language-plaintext highlighter-rouge">-a &lt;args&gt;</code>: arguments for POSIX program
    <ul>
      <li><code class="language-plaintext highlighter-rouge">cron -n</code>: make cron run in the foreground</li>
    </ul>
  </li>
</ul>

<p>You can then do the following (some may need to be run as admin):</p>
<ul>
  <li>Query <code class="language-plaintext highlighter-rouge">cron</code> status: <code class="language-plaintext highlighter-rouge">cygrunsrv --query cron</code></li>
  <li>Start <code class="language-plaintext highlighter-rouge">cron</code>: <code class="language-plaintext highlighter-rouge">cygrunsrv --start cron</code></li>
  <li>Stop <code class="language-plaintext highlighter-rouge">cron</code>: <code class="language-plaintext highlighter-rouge">cygrunsrv --stop cron</code></li>
  <li>Remove <code class="language-plaintext highlighter-rouge">cron</code> daemon: <code class="language-plaintext highlighter-rouge">cygrunsrv -R cron</code></li>
</ul>

<p>Afterwards, you can setup cronjobs using <code class="language-plaintext highlighter-rouge">crontab -e</code> just like you’re used to.</p>

<p>The cron daemon will start automatically when you boot Windows and log in.</p>

<p>To then make use of the script, I added this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*/10 * * * * /cygdrive/c/Users/[redacted]/AppData/Local/Programs/Python/Python311/python "C:\Users\[redacted]\Scripts\hide-files.py" "C:\Users\[redacted]" "D:\\" "E:\\" -d 2
</code></pre></div></div>

<p>The above states that every 10 minutes, it will run <code class="language-plaintext highlighter-rouge">python.exe hide-files.py</code> with a few arguments.</p>

<h2 id="use-ctrlh-in-windows-explorer">Use <code class="language-plaintext highlighter-rouge">Ctrl+H</code> in Windows Explorer</h2>

<p>There are a few hotkeys that I wish would just work under Windows.
For example, under Linux I can use <code class="language-plaintext highlighter-rouge">Ctrl+H</code> to toggle hidden entries. This works with Nautilus, Dolphin, Nemo, Thunar, and many other popular Linux file managers. But not in Windows Explorer.</p>

<p>For this, I’ve found that a little dabbling with AutoHotkey can help a lot.</p>

<p>If you don’t know <a href="https://www.autohotkey.com/">AutoHotkey</a>,
it is a free, open-source scripting language for Windows that essentially allows you to make complex macros.
(But this only scratches the surface)</p>

<p>Here’s an excerpt from my AutoHotkey script:</p>
<pre><code class="language-ahk">; Ctrl+H to toggle hidden files
; Hide/Show hidden files in Windows file explorer
^h::
If WinExist("ahk_exe Explorer.EXE") &amp;&amp; WinActive("ahk_exe Explorer.EXE")
{
	; Toggle registry entry
	RegRead, HiddenVal, HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced, Hidden
	If HiddenVal = 2
	{
		RegWrite, REG_DWORD, HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced, Hidden, 1
	}
	Else
	{
		RegWrite, REG_DWORD, HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced, Hidden, 2
	}
	; Refresh window
	Send ^{F5}
}
Return
</code></pre>

<p>What it does:</p>
<ul>
  <li>When you press <code class="language-plaintext highlighter-rouge">Ctrl+H</code> (see <code class="language-plaintext highlighter-rouge">^h::</code>)…
    <ul>
      <li>then check if <code class="language-plaintext highlighter-rouge">Explorer.EXE</code> is running and is the active window. If that’s the case:
        <ul>
          <li>read the registry value <code class="language-plaintext highlighter-rouge">Hidden</code> in the key <code class="language-plaintext highlighter-rouge">HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced</code> and write the result into the ahk variable <code class="language-plaintext highlighter-rouge">HiddenVal</code></li>
          <li>toggle the registry value with the help of <code class="language-plaintext highlighter-rouge">HiddenVal</code></li>
          <li>send <code class="language-plaintext highlighter-rouge">F5</code> to refresh the file explorer</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>You can simply copy and paste it into a file with the <code class="language-plaintext highlighter-rouge">.ahk</code> extension and double-click it. You can also compile it into an <code class="language-plaintext highlighter-rouge">.exe</code> file for portable use.</p>

<h2 id="further-reading">Further reading</h2>

<p>There’s actually a project on GitHub that uses DLL injection to hide dotfiles.<br />
You may want to check this out: <a href="https://github.com/joshumax/WinHideEx">github.com/joshumax/WinHideEx</a></p>

<p>If found reading this part quite amusing, as this is what I’ve been doing (and explaining in this article):</p>
<blockquote>
  <p>Yes, I’m aware that you can manually mark all of them with the “hidden” attribute but it’s like playing NTFS whack-a-mole with a filesystem watcher script.</p>
</blockquote>

<p>So, if you’re interested in a different (and perhaps more elegant) solution, give WinHideEx a try.</p>

  </div><a class="u-url" href="/2023/06/14/hide-dotfiles-on-windows.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="http://localhost:4000/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">FelisDiligens</li>
          <li><a class="u-email" href="mailto:felisdiligens@yahoo.com">felisdiligens@yahoo.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Just a place where I dump stuff...</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/FelisDiligens" target="_blank" title="GitHub">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.nexusmods.com/fallout76/users/41275740" target="_blank" title="NexusMods">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#nexusmods"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.npmjs.com/~felisdiligens" target="_blank" title="npm">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#npm"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://ko-fi.com/felisdiligens" target="_blank" title="Ko-fi">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#kofi"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://discourse.joplinapp.org/u/felisdiligens" target="_blank" title="Joplin Forum">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#joplin"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
